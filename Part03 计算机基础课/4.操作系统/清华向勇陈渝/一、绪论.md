# 一、绪论

## 1、操作系统概述

- 什么是操作系统？
  - 从用户角度上，操作系统是一个控制软件。
    - 管理应用程序。
    - 为应用程序提供服务。
    - 杀死应用程序。
  - 从计算机角度，操作系统是一个资源管理软件。
    - 资源管理。
    - 管理外设、分配资源。
  - 将CPU抽象为进程，将磁盘抽象为文件，将内存抽象为地址空间。
  - 是计算机科学研究的基石之一，计算机系统的基本组成部分。
- 操作系统架层次结构：硬件之上、应用程序之下。
- 操作系统属于系统软件，面向应用程序的接口称为 shell ，面向计算机内部资源的接口称为 kernel 。如操作系统的图形化或命令行界面就属于 shell 。
- Kernel 是操作系统内部组件，包括：
  - CPU 调度器。
  - 物理内存管理。
  - 虚拟内存管理。
  - 文件系统管理。
  - 中断处理与设备驱动。
- 操作系统 Kernel 的特征：
  - 并发。计算机系统中在一段时间内同时存在多个运行的程序，需要操作系统管理和调度。（在同一时间点称为并行）
  - 共享。应用程序共享计算机系统的硬件资源，“同时”访问或互斥共享。
  - 虚拟。利用多道程序设计技术，将硬件资源虚拟化。
  - 异步。程序的执行不是一贯到底，而是走走停停。但只要运行环境相同，操作系统需要保证程序运行的结果相同。
- 操作系统的意义和要达到的要求：
  - 操作系统需要对并发进行管理。
  - 操作系统的代码管理原始硬件，需要对硬件遇到的不同情况进行处理。
  - 操作系统代码必须是高效的，低耗CPU、内存、磁盘的。
  - 操作系统需要比其他程序拥有更高的稳定性。
  - 操作系统是系统安全的基础。
  - 操作系统需要权衡：空间和时间、性能和可预测性、公平和性能。
  - 硬件方面，操作系统需要良好的硬件管理、合理的资源分配。
- 操作系统的发展：
  - 1955~1965年，顺序执行与批处理。
  - 1965年~1980年，随着硬件的发展，CPU可以执行多个程序，保持多个工作在内存中并且复用CPU，出现了多道程序设计。
  - 1970年~，为了更好的用户交互，定时中断用于工作对CPU的复用，出现了分时调度系统。
  - 出现了个人电脑系统，操作系统需要支持协调和沟通多应用系统，急切的需求是提高 IO 交互性。
  - 随着网络的发展，出现了分布式操作系统。
  - 未来的趋势，普适计算、云计算的大数据。
- 操作系统设计结构：
  - 微内核的设计，将内核的一些功能移到用户空间，以服务和进程形式存在。效率较低。
  - 外核架构，内核分为两部分，一部分用于硬件资源的复制，另一部分解决具体应用对硬件的访问。
  - 虚拟机监视器，建立在已有的操作系统上，虚拟出了一整套计算机资源，多操作系统共享硬件资源。

## 2、操作系统实验准备

- x86-32 硬件运行模式：
  - x86 指 intel 80386，有四种运行模式：实模式、保护模式、SMM模式和虚拟8086模式。
  - 实模式：80386加电启动后处于实模式运行状态，在这种状态下软件可访问的物理内存空间不能超过1MB，且无法发挥Intel 80386以上级别的32位CPU的4GB内存管理能力。
  - 保护模式：支持内存分页机制，提供了对虚拟内存的良好支持。
    - 保护模式下80386支持多任务，还支持优先级机制，不同的程序可以运行在不同的优先级上。
    - 优先级一共分0~34个级别，操作系统运行在最高的优先级0上，应用程序则运行在比较低的级别上。
    - 配合良好的检查机制后，既可以在任务间实现数据的安全共享也可以很好地隔离各个任务。
- 地址是访问内存空间的索引。

  - 80386是32位处理器，即可以寻址的物理内存地址空间为 4G 字节。

  - 物理内存地址空间，是处理器提交到总线上用于访问计算机系统中的内存和外设的最终地址。一个计算机系统中只有一个物理地址空间。
  - 线性地址空间，是在操作系统的虚存管理之下每个运行的应用程序能访问的地址空间。每个运行的应用程序都认为自己独享整个计算机系统的地址空间，这样可让多个运行的应用程序之间相互隔离。
  - 逻辑地址空间，是应用程序之间使用的地址空间。
  - 段机制启动、页机制未启动：逻辑地址->段机制处理(映射到)->线性地址=物理地址。
  - 段机制和页机制都启动：逻辑地址->段机制处理(映射到)->线性地址->页机制处理(映射到)->物理地址。
- 80386的寄存器可以分为8组：

  - 通用寄存器；
    - EAX：累加器；
    - EBX：基址寄存器；
    - ECX：计数器；
    - EDX：数据寄存器；
    - ESI：源地址指针寄存器；
    - EDI：目的地址指针寄存器；
    - EBP：基址指针寄存器；
    - ESP：堆栈指针寄存器。
  - 段寄存器；
    - CS：代码段（Code Segment）；
    - DS：数据段（Data Segment）；
    - ES：附加数据段（Extra Segment）；
    - SS：堆栈段（Stack Segment）；
    - FS：附加段；
    - GS：附加段。
  - 指令指针寄存器；
    - EIP：指令寄存器；
    - EIP的低16位就是8086的IP，它存储的是下一条要执行指令的内存地址，在分段地址转换中，表示指令的段内偏移地址。
  - 标志寄存器；
    - EFLAGS：标志寄存器；
    - IF（（Interrupt Flag）：中断允许标志位，由CLl，STI两条指令来控制；设置IF使CPU可识别外部（可屏蔽）中断请求。复位IF则禁止中断。IF对不可屏蔽外部中断和故障中断的识别没有任何作用。
    - CF，PF，ZF.…
  - 控制寄存器；
  - 系统地址寄存器，调试寄存器，测试寄存器。

- 





