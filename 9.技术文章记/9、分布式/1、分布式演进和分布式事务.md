学习自：

- [三歪非要听我说完分布式才肯睡](https://mp.weixin.qq.com/s/uv9xYgYrHWqM5acXQYFegA)
- [1.4 w字，25 张图让你彻底掌握分布式事务原理](https://mp.weixin.qq.com/s/ujRRtdLOeKEHsHrtDRNXGA)



## 1、分布式演进

- 在项目的初期，为了开发简便，一般会先使用单体应用架构：

  - 好处是：
    - 简单粗暴，本地开发调试方便。
    - 本地函数调用，没有网络调用的开销。
  - 坏处是：
    - 系统的耦合性高，随着规模增大开发效率低下。
    - 对某些模块的修改可能会影响其他模块。
    - 语言单一，不能根据场景选择更加合适的语言。
    - 系统的可靠性不高。
    - 系统不易扩展部署。

  ![image-20210226174359244](G:\Part One+\Part9 code notes\9.技术文章记\9、分布式\img\1、分布式演进和分布式事务\image-20210226174359244.png)

  - 如果要开发手机版，就粗暴的拷贝现有的应用，稍加修改即可。发现很多功能代码都是重复的。这时候来个需求改的就是多份代码了。

  ![image-20210226174433810](G:\Part One+\Part9 code notes\9.技术文章记\9、分布式\img\1、分布式演进和分布式事务\image-20210226174433810.png)

- 微服务架构：

  - 根据不同业务拆分出不同的服务，并且会整理出当前公共的功能变成一个公共服务，每个服务独立部署，独立运行，代码进行了物理隔离，一个小团队维护一个服务或多个服务。
  - 并且一般而言服务化了，数据库也会拆分出来每个服务维护自己的数据库，数据库之间的数据通过接口传递，而不再是直接访问。

  ![image-20210226174627206](G:\Part One+\Part9 code notes\9.技术文章记\9、分布式\img\1、分布式演进和分布式事务\image-20210226174627206.png)

  - 微服务解决了单体应用的什么问题：
    - 系统的耦合度降低了。
    - 系统的可靠性增加了。
    - 技术选型丰富，不同的服务可以利用不同的技术或语言实现。
    - 可根据服务扩展部署。
  - 微服务出现了什么新问题：
    - 出现修改时，如果修改涉及到多个服务，服务上线比较麻烦。
    - 调用链路变长，调用增加了网络的开销，性能变差。而且出错难以定位问题来源。需要引入**分布式链路追踪**服务来定位问题。
    - 为了能够动态扩容，你的服务需要自动注册且能被自动发现，因此需要个**注册中心**。
    - 网络之间的调用较为不可靠，因此还需要让调用有**重试机制**。防止其他服务出 bug 或其他原因疯狂调用你的服务，还需要有**限流措施**。为了防止一个服务挂了导致整体的雪崩需要有**熔断措施**。
    - 为了在特殊时候例如大促的时候让出硬件资源给核心功能，还需要有**降级策略**。
    - 而且每个服务都需要配置，因此还得有个**配置中心**，来做统一管理。
  - 服务化之后解耦了业务，却又融入了非业务相关的东西。

- SOA和微服务：

  - SOA，全称 `Service-Oriented Architecture`即面向服务的架构。ESB，全称`Enterprise Service Bus`即企业服务总线。SOA和微服务一样都是面向服务的。

  ![image-20210226175820174](G:\Part One+\Part9 code notes\9.技术文章记\9、分布式\img\1、分布式演进和分布式事务\image-20210226175820174.png)

  - SOA 架构通过企业服务总线进行交互，也就是说中心化，需要按照总线的标准进行开发改造，而微服务是去中心化的。
  - SOA 认为是企业级别的面向服务概念，而微服务是应用级别的概念。
  - 两种都是面向服务，只是 SOA 注重的是企业资源的重复利用，把企业的各个应用通过 ESB 进行整合。而微服务注重的是应用级别的服务划分，使得应用内服务边界清晰，易扩展。
  - 这两者其实是两个方向的面向服务，互不冲突。还能是SOA包含微服务的结构。

- 分布式和集群：

  - 分布式可以认为是通过网络连接多个组件而形成的系统。
  - 我们常提到的分布式是狭义上的，指代不同的组件通过协作构成的系统。
  - 而集群常指的同一个组件多实例而构成逻辑上的整体。





## 2、分布式事务

- 

















